<template>
    <form onsubmit="return false;">
        <div>
            Convert
            <input :value="inputAmount"  @input="updateInputAmount" placeholder="enter amount">
            <select :value="inputCurrency"  @input="updateInputCurrency" id="input_currency">
                <option v-for="option in currencies" :value="option" :key="option">
                    {{ option }}
                </option>
            </select> to 
            <select :value="outputCurrency"  @input="updateOutputCurrency" id="output_currency">
                <option v-for="option in currencies" :value="option" :key="option">
                    {{ option }}
                </option>
            </select>
            <button @click="convert" type="submit" :disabled="!valid" id="convert">Convert</button>
        </div>
        <div id="result">
            {{ result }}
        </div>
    </form>
</template>

<script>
import { mapState } from 'vuex'

export default {
  name: 'Currency',
    computed: {
        ...mapState({
            valid: state => /^[0-9]+.?[0-9]?[0-9]?$/.test(state.currency.inputAmount)
             && state.currency.inputCurrency
              && state.currency.outputCurrency,
            inputAmount: state => state.currency.inputAmount,
            inputCurrency: state => state.currency.inputCurrency,
            outputCurrency: state => state.currency.outputCurrency,
            currencies: state => state.currency.currencies,
            result: state => state.currency.result
        })
    },
    methods: {
        updateInputAmount (e) {
            this.$store.commit('updateInputAmount', e.target.value)
        },
        updateInputCurrency (e) {
            this.$store.commit('updateInputCurrency', e.target.value)
        },        
        updateOutputCurrency (e) {
            this.$store.commit('updateOutputCurrency', e.target.value)
        },
        convert () {
            this.$store.dispatch('convert')
        },
    },
    created() {
         this.$store.dispatch('loadCurrencies')
    }   
}
</script>

<style scoped>
</style>